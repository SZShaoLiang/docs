### 实现Availability(可用性)和Partition tolerance(分区容忍性)事务方式

#### http(复制状态机 + saga):

+ 收到错误消息或者超时阀值回滚状态机
+ 顺序等待事件，非期待事件先到挂起，这种情况一般发生在状态机没有同步时
+ 命令模式包装事务方法，提供基于本地事件表的消息发送和本地事务的原子性，提供状态机回滚时事务的确定性
+ 状态流程使用注解@process，使用代理模式和线程隔离
+ 状态机提供持久话，使用时间和空间办法定期删除，更推荐时间，错误状态记录由监控线程抓获记录到持久化存储，提供人工干预
+ 实现事务的不同级别，在源头处配置
+ 语言原生实现方法级别的状态
+ 使用go实现sidecar,提取状态机属性（参考istio属性store)到etcd或sidecar直接集成distributed storage。
+ 状态的提取？业务代码里使用sdk加入到HTTP Header或者外部预先配置

#### MQ最终一致性(Kafka正好一次或者RocketMQ)：

+ 使用同一个topic，使用组来实现云原生
+ kafka开启事务，实现正好一次发送
+ 不用每个操作都和状态机交互，只需要业务的结束状态操作返回commit即可
+ 开启异常topic，有可能实现回滚（1）

### 实现Consistency(一致性)和Partition tolerance(分区容忍性)事务方式

